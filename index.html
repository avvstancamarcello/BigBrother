<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-key="page_title">Big Brother The Musical - Collezione Immagini NFT</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta name="theme-color" content="#4CAF50">
    <!-- ethers.js e abi.js -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="abi.js"></script>
    <script src="main.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 20px;
            text-align: center;
            line-height: 1.6;
            font-size: 16px;
        }
        h1 { color: #4CAF50; font-size: 2.2em; margin-bottom: 10px; }
        h2 { color: #2e7d32; font-size: 1.8em; margin-top: 40px; margin-bottom: 15px; }
        h3 { color: #1b5e20; font-size: 1.4em; margin-top: 30px; margin-bottom: 10px; text-align: left; }
        p { text-align: justify; margin-bottom: 10px; font-size: 1em; }
        ul { text-align: left; list-style-position: inside; padding-left: 20px; font-size: 1em; }
        li { margin-bottom: 5px; }
        .intro-text, .content-section {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            font-size: 1.1em;
            font-style: italic;
            color: #1b5e20;
            text-align: center;
        }
        .content-section { background-color: #fff; font-style: normal; color: #333; text-align: left; }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .image-card {
            background-color: #e8f5e9;
            border: 1px solid #c8e6c9;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }
        .image-card img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            margin-bottom: 10px;
            border: 2px solid #81c784;
            cursor: pointer;
        }
        .image-card p {
            font-weight: bold;
            color: #2e7d32;
            margin: 5px 0 0;
            font-size: 1em;
        }
        .mint-btn {
            margin-top: 8px;
            padding: 7px 16px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }
        .mint-btn:hover, .mint-btn:focus {
            background-color: #388e3c;
        }
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            font-size: 0.8em;
            color: #777;
            text-align: center;
        }
        .lang-switcher { text-align: right; margin-bottom: 15px; }
        .lang-button {
            background-color: #007bff;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            touch-action: manipulation;
        }
        .lang-button:hover { background-color: #0056b3; }
        .image-instruction {
            color: green;
            font-family: Arial, sans-serif;
            font-size: 1.1em;
            text-align: center;
            margin-top: -20px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .privacy-policy-section {
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f8f8f8;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: left;
            border: 1px solid #eee;
        }
        .privacy-policy-section h2, .privacy-policy-section h3 {
            color: #4CAF50;
            text-align: center;
        }
        .privacy-policy-section p { font-size: 0.95em; line-height: 1.5; }
        .privacy-policy-section ul { font-size: 0.95em; }
        .security-recommendation-note {
            max-width: 900px;
            margin: 30px auto;
            padding: 20px;
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 8px;
            color: #856404;
            text-align: justify;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
                .security-recommendation-note h3 {
            color: #856404;
            text-align: center;
        }
        
        /* Modal Responsive per Pop-up */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            cursor: pointer;
        }
        
        .modal-content {
            margin: auto;
            display: block;
            max-width: 90vw;
            max-height: 90vh;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        
        .modal-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        .orwell-quote {
            font-weight: bold;
            color: #007bff;
            font-size: 1.8em;
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .nft-value {
            font-size: 1.4em;
            color: #4CAF50;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
        }
        
        /* Wallet Selector */
        .wallet-selector {
            margin: 20px 0;
            text-align: center;
        }
        
        .wallet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .wallet-btn {
            padding: 10px 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .wallet-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Wallet Modal Styles */
        .wallet-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .wallet-selector {
            background: white;
            border-radius: 12px;
            padding: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        .wallet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #ff0000;
            padding-bottom: 10px;
        }
        
        .wallet-header h3 {
            color: #ff0000;
            margin: 0;
        }
        
        .wallet-close {
            font-size: 30px;
            color: #ff0000;
            cursor: pointer;
            font-weight: bold;
        }
        
        .wallet-close:hover {
            color: #cc0000;
        }
        
        .mint-info {
            background: rgba(255,0,0,0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .mint-info p {
            margin: 5px 0;
            font-weight: bold;
        }
        
        .wallet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }
        
        .wallet-option {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .wallet-option:hover {
            border-color: #ff0000;
            background: rgba(255,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .wallet-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .wallet-name {
            font-weight: bold;
            color: #333;
        }
        
        @media (max-width: 768px) {
            body { margin: 10px; }
            .intro-text, .content-section { padding: 15px; }
            h1 { font-size: 1.8em; }
            h2 { font-size: 1.4em; }
            h3 { font-size: 1.2em; }
            .image-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
                padding: 15px;
            }
            .image-card { padding: 10px; }
            .lang-switcher { text-align: center; }
            
            .modal-content {
                max-width: 95vw;
                max-height: 85vh;
            }
            
            .orwell-quote {
                font-size: 1.4em;
            }
            
            .wallet-grid {
                grid-template-columns: 1fr;
            }
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0; top: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            display: block;
            margin: auto;
            max-width: 90vw;
            max-height: 80vh;
            border-radius: 10px;
            box-shadow: 0 4px 32px rgba(0,0,0,0.3);
        }
        .close {
            position: absolute;
            top: 20px; right: 32px;
            color: #fff;
            font-size: 2.5em;
            font-weight: bold;
            cursor: pointer;
            z-index: 101;
        }
        @media (max-width: 600px) {
            .modal-content { max-width: 98vw; max-height: 70vh; }
            .close { right: 16px; top: 8px; }
        }
        @media (max-width: 768px) {
            body { margin: 10px; font-size: 15px; }
            h1 { font-size: 1.8em; }
            h2 { font-size: 1.5em; }
            h3 { font-size: 1.2em; }
            .intro-text, .content-section, .security-recommendation-note, .privacy-policy-section {
                padding: 15px;
                margin: 15px auto;
                max-width: 100%;
            }
            .image-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 15px;
                padding: 15px;
            }
            .image-card { padding: 10px; }
            .lang-switcher { text-align: center; }
        }
        @media (max-width: 480px) {
            body { font-size: 14px; }
            h1 { font-size: 1.6em; }
            h2 { font-size: 1.3em; }
            h3 { font-size: 1.1em; }
            .image-grid {
                grid-template-columns: 1fr;
                gap: 10px;
                padding: 10px;
            }
            .image-card img { max-width: 80%; }
            .image-instruction { font-size: 1em; }
        }
    </style>
</head>
<body>
    <!-- BEGIN: VIDEO-MUSICAL-SECTION -->
    <!-- Sentinel per sostituzioni automatiche future -->
    <section id="video-musical" style="margin:40px auto; max-width:820px;">
        <h2 style="font-size:1.6em; margin-bottom:10px;">Trailer / Video: Big Brother The Musical</h2>
        <video controls playsinline preload="metadata" width="800" poster="images-preview/OrwellBanner.png" 
               aria-label="Trailer Big Brother The Musical" 
               title="Video promozionale del musical Big Brother"
               style="max-width:100%; border:2px solid #4CAF50; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2);">
            <source src="images-preview/BBTMTheMusical.mp4" type="video/mp4">
            Il tuo browser non supporta il tag video HTML5. Se il video non parte, puoi scaricarlo direttamente dal link sopra.
        </video>
        <p style="margin-top:8px;">
            <a href="images-preview/BBTMTheMusical.mp4" target="_blank" rel="noopener">Guarda il trailer in una nuova scheda</a> |
            <a href="images-preview/BBTMTheMusical.mp4" download>Scarica il video</a>
        </p>
    </section>
    <!-- END: VIDEO-MUSICAL-SECTION -->

    <div class="lang-switcher">
        <button class="lang-button" id="toggleLangButton" onclick="switchLanguage()" aria-live="polite" aria-label="Cambia lingua">Traduci e leggi in lingua inglese</button>
    </div>

    <main role="main">
        <h1 data-key="main_page_title" id="main_page_title">Collezione NFT "Big Brother The Musical"</h1>
        <h2 data-key="main_subtitle" id="main_subtitle">Crowdfunding artistico musicale.<br>Presentazione alla stampa</h2>
        <div class="intro-text" role="region" aria-labelledby="main_page_title">
            <p data-key="intro_para1">Osservate queste immagini. Quella che vedete non √® una semplice galleria di immagini, ma qualcosa di veramente innovativo! ‚ú® √à una galleria di <b>valori digitali</b>, opere d'arte originali, rappresentative di un progetto creativo ambizioso, tutelato da copyright, costruttore di nuovi valori per i possessori, ma condivisibile. üí°</p>
            <p data-key="intro_para2">Vi spiego con ordine üëá</p>
        </div>
        <p data-key="image_instruction_text" class="image-instruction" id="image_instruction">Mostra immagine a schermo intero con un click su qualsiasi immagine</p>

        <div class="image-grid" id="image-container" role="region" aria-labelledby="image_instruction"></div>

        <!-- Modal per visualizzazione ingrandita -->
        <div id="modal" class="modal" onclick="closeModal()" style="display:none">
            <span class="close" onclick="closeModal()">&times;</span>
            <img class="modal-content" id="modal-img">
        </div>

        <!-- About Section -->
        <div class="content-section" style="padding: 20px; text-align: center; background: rgba(0,0,0,0.8); margin: 20px; color: white;">
            <h2 style="color: #ff0000;">About Big Brother Token Movement</h2>
            <p>The Big Brother Token Movement (BBTM) represents digital resistance against surveillance capitalism through blockchain technology.</p>
        </div>

        <!-- Orwell Quotes Section -->
        <div class="content-section" style="padding: 20px; text-align: center; background: rgba(255,0,0,0.1); margin: 20px;">
            <h2 style="color: #ff0000;">George Orwell's Vision</h2>
            <p>"Big Brother is watching you. War is peace. Freedom is slavery. Ignorance is strength."</p>
            <p>Collect all 20 NFTs to complete Orwell's prophetic warnings about surveillance and control.</p>
        </div>

        <!-- How it Works -->
        <div class="content-section" style="padding: 20px; text-align: center; background: rgba(0,0,0,0.8); margin: 20px; color: white;">
            <h2 style="color: #ff0000;">Token Economics</h2>
            <p>Each NFT contains a piece of Orwell's wisdom, valued from 5 to 100 BBTM tokens based on rarity and significance.</p>
        </div>

        <div class="content-section" role="region" aria-labelledby="official_presentation_title">
            <h2 data-key="official_presentation_title" id="official_presentation_title">Presentazione Ufficiale: "Big Brother The Musical" ‚Äì L'Opera Definitiva Finanziata dalla Blockchain üéâ</h2>
            <h3 data-key="section_intro_project" id="section_intro_project">Introduzione al Progetto üé≠</h3>
            <p data-key="intro_project_para1">Io sono qui oggi per presentarvi un progetto che trascende i confini dell'arte e della tecnologia: "Big Brother The Musical". Non √® solo una nuova opera lirica e teatrale; √® un ponte tra la genialit√† creativa e il futuro del finanziamento decentralizzato. Dietro questa ambizione, c'√® un team d'eccellenza e una solida infrastruttura digitale che cambier√† il modo di concepire il crowdfunding per le grandi produzioni artistiche.</p>
            <h3 data-key="section_philosophy_defi" id="section_philosophy_defi">La Filosofia DeFi e il Vantaggio degli NFT üîó</h3>
            <p data-key="philosophy_defi_para1">Immaginate la finanza decentralizzata (DeFi) come un meccanismo che aggrega gli investimenti non tramite banche o intermediari tradizionali, ma direttamente attraverso la comunit√† globale, con la massima trasparenza. La convenienza di aggregare investimenti tramite la vendita degli NFT √® straordinaria: voi investite in un bene digitale unico, che acquisisce valore con il successo del progetto, e al tempo stesso sostenete direttamente un'opera d'arte grandiosa. üöÄ</p>
            <h3 data-key="section_smart_contract" id="section_smart_contract">Lo Smart Contract: Il Cuore Tecnologico della Produzione üõ°Ô∏è</h3>
            <p data-key="smart_contract_para1">Il cuore pulsante di questa iniziativa: lo Smart Contract "Big Brother The Musical", la nostra "Zecca Digitale". √à con immenso orgoglio che io, in qualit√† di presentatore, evidenzio la sua paternit√†: l'autore e regista di questo capolavoro di codice √® l'Avvocato Marcello Stanca di Firenze <a href="https://github.com/avvstancamarcello" target="_blank">@AvvMarcelloStanca</a>.</p>
            <p data-key="smart_contract_para2">Ho assistito in prima persona alla genesi di questo Smart Contract e posso testimoniare che √® un'opera complessa e articolata, ma al tempo stesso incredibilmente robusta e resistente agli attacchi informatici. Il lavoro necessario all'Avvocato Stanca √® stato pionieristico; egli ha affrontato la costruzione dello Smart Contract come un corpus unico, efficace ed autosufficiente.</p>
            <h3 data-key="section_blockchain_security" id="section_blockchain_security">La Tracciabilit√† su Blockchain: Trasparenza e Sicurezza üåç</h3>
            <p data-key="blockchain_security_para1">Ogni transazione √® tracciabile e immediatamente registrata su una rete blockchain mondiale. Questo √® possibile grazie a un registro distribuito su numerosi nodi in cloud, indipendenti e non alterabili.</p>
            <h3 data-key="section_team" id="section_team">Il Team d'Eccellenza: Garanzia di Affidabilit√† üåü</h3>
            <ul>
                <li data-key="team_member1">Avv. Marcello Stanca di Firenze <a href="https://github.com/avvstancamarcello" target="_blank">@AvvMarcelloStanca</a>, autore dello Smart Contract.</li>
                <li data-key="team_member2">M¬∞ Stefano Burbi, compositore e direttore d'orchestra.</li>
                <li data-key="team_member3">Fabrizio Carbon, produttore esecutivo di fama internazionale.</li>
            </ul>
            <h3 data-key="section_art_collecting" id="section_art_collecting">L'Arte e il Collezionismo Digitale: NFT Iconici üñºÔ∏è</h3>
            <p data-key="art_collecting_para1">Abbiamo dedicato un raffinato lavoro alla composizione grafica degli NFT. L'obiettivo √® proporre NFT originali ed accattivanti, capaci di stimolare l'interesse del collezionista ad acquistare l'intera "collezione".</p>
            <h2 data-key="call_to_action_title" id="call_to_action_title">Invito all'Investimento e Qualit√† del Progetto üöÄ</h2>
            <p data-key="call_to_action_para1">Investire in "Big Brother The Musical" significa sostenere l'arte, innovare la finanza e possedere un pezzo di storia digitale. Unisciti a noi!</p>
        </div>

        <section class="privacy-policy-section" id="privacy-policy" role="region" aria-labelledby="privacy_policy_title">
            <h2 data-key="privacy_policy_title" id="privacy_policy_title">Privacy Policy</h2>
            <h3 data-key="data_collection_title">Raccolta Dati Personali</h3>
            <p data-key="data_collection_para1">üîí <strong></strong>Questo sito non raccoglie dati personali</strong>. L'acquisto di NFT e FT viene eseguito dall'utente tramite applicazioni anonime (MetaMask, Coinbase Wallet, Trust Wallet, Binance Wallet, etc.) che registrano sulla blockchain solo dati alfanumerici anonimi. Le transazioni rispettano la massima privacy e anonimato garantiti dalla tecnologia blockchain decentralizzata.</p>
            <h3 data-key="cookies_tracking_title">Cookie e Tecnologie di Tracciamento</h3>
            <p data-key="cookies_tracking_para1">Non utilizziamo cookie o tecnologie di tracciamento per monitorare il comportamento degli utenti.</p>
            <h3 data-key="ipfs_content_title">Contenuti Ospitati su IPFS</h3>
            <p data-key="ipfs_content_para1">Le immagini e i metadati degli NFT sono ospitati su IPFS tramite gateway pubblici. Non abbiamo controllo sulle pratiche di privacy dei gateway IPFS.</p>
            <h3 data-key="blockchain_data_title">Dati Blockchain</h3>
            <p data-key="blockchain_data_para1">Tutte le transazioni NFT avvengono sulla blockchain Polygon. I dati registrati sono pubblici e immutabili.</p>
            <h3 data-key="external_links_title">Collegamenti Esterni</h3>
            <p data-key="external_links_para1">Questa pagina pu√≤ contenere collegamenti a piattaforme e servizi esterni. Non siamo responsabili per le loro pratiche di privacy.</p>
            <h3 data-key="changes_policy_title">Modifiche a questa Policy</h3>
            <p data-key="changes_policy_para1">Questa Policy pu√≤ essere aggiornata in futuro.</p>
            <p data-key="last_updated_text">Ultimo aggiornamento: 2 Agosto 2025</p>
            <h3 data-key="contact_title">Contatti</h3>
            <p data-key="contact_para1">Per domande, contattaci tramite i canali ufficiali del progetto.</p>
        </section>

        <section class="security-recommendation-note" id="security-recommendation-note" role="region" aria-labelledby="security_recommendation_title">
            <h3 data-key="security_recommendation_title" id="security_recommendation_title">Raccomandazioni per la Visualizzazione Contenuti IPFS</h3>
            <p data-key="security_reco_para1">Alcuni link puntano a contenuti su IPFS. Potrebbero comparire avvisi di sicurezza da parte di browser o antivirus. Procedere solo se si √® certi dell'affidabilit√† della fonte.</p>
        </section>
    </main>
    <div class="footer">
        <p data-key="footer_text">Powered by Big Brother The Musical - Smart Contract by Avv. Marcello Stanca ¬© Giugno 2025</p>
        <p><a href="#privacy-policy" data-key="footer_privacy_link">Privacy Policy</a></p>
    </div>

    <script>
    // Frase famosa di George Orwell divisa in 20 parti
    const orwellQuote = [
        "Big", "Brother", "is", "watching", 
        "you.", "War", "is", "peace,", 
        "freedom", "is", "slavery,", "ignorance", 
        "is", "strength.", "Doublethink", "means", 
        "the", "power", "of", "holding."
    ];
    
    // Galleria immagini con valori BBTM progressivi
    const imageNames = [
      "5_watermarked_double_watermarked.png", "10_watermarked_double_watermarked.png", "15_watermarked_double_watermarked.png", "20_watermarked_double_watermarked.png",
      "25_watermarked_double_watermarked.png", "30_watermarked_double_watermarked.png", "35_watermarked_double_watermarked.png", "40_watermarked_double_watermarked.png",
      "45_watermarked_double_watermarked.png", "50_watermarked_double_watermarked.png", "55_watermarked_double_watermarked.png", "60_watermarked_double_watermarked.png",
      "65_watermarked_double_watermarked.png", "70_watermarked_double_watermarked.png", "75_watermarked_double_watermarked.png", "80_watermarked_double_watermarked.png",
      "85_watermarked_double_watermarked.png", "90_watermarked_double_watermarked.png", "95_watermarked_double_watermarked.png", "100_watermarked_double_watermarked.png"
    ];
    
    const imageContainer = document.getElementById('image-container');
    imageNames.forEach((name, index) => {
      const value = (index + 1) * 5; // Valori da 5 a 100
      const quoteWord = orwellQuote[index]; // Parola della frase
      
      const imageCard = document.createElement('div');
      imageCard.className = 'image-card';
      imageCard.innerHTML = `
        <img src="images/officials-preview/Watermarked_double/${name}" alt="BBTM NFT #${index + 1} - ${quoteWord}"
             onclick="openModal('images/officials-preview/Watermarked_double/${name}', '${quoteWord}', ${value})"
             onkeydown="if(event.key==='Enter'||event.key===' '){openModal('images/officials-preview/Watermarked_double_compressed/${name}', '${quoteWord}', ${value})}"
             tabindex="0">
        <div class="nft-value">${value} BBTM</div>
        <p><strong>${quoteWord}</strong></p>
        <button class="mint-btn" onclick="mintNFT('${name}', ${value}, '${quoteWord}', event)">Mint NFT</button>
      `;
      imageContainer.appendChild(imageCard);
    });
    function openModal(src, quoteWord, value) {
      const modal = document.getElementById('modal');
      modal.innerHTML = `
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-overlay">
          <img class="modal-content" src="${src}" alt="Big Brother NFT">
          <div class="orwell-quote">${quoteWord}</div>
          <div class="nft-value">${value} BBTM Token</div>
          <p>Parte della frase immortale di George Orwell</p>
          <button class="mint-btn" onclick="mintNFT('${src.split('/').pop()}', ${value}, '${quoteWord}', event)">Mint NFT - ${value} BBTM</button>
        </div>
      `;
      modal.style.display = "block";
    }
    
    function closeModal() {
      document.getElementById('modal').style.display = "none";
    }
    
    function mintNFT(filename, value, quoteWord, event) {
      event.stopPropagation();
      showWalletSelector(filename, value, quoteWord);
    }
    
    function showWalletSelector(filename, value, quoteWord) {
      const walletModal = document.createElement('div');
      walletModal.id = 'wallet-modal';
      walletModal.className = 'wallet-modal-overlay';
      
      const wallets = [
        'MetaMask', 'WalletConnect', 'Coinbase Wallet', 'Trust Wallet', 'Rainbow',
        'Phantom', 'Solflare', 'Exodus', 'Atomic Wallet', 'SafePal',
        'TokenPocket', 'Math Wallet', 'Binance Chain Wallet', 'Torus', 'Portis',
        'Fortmatic', 'Authereum', 'Squarelink', 'Bitski', 'Venly',
        'WalletLink', 'Gnosis Safe', 'Argent', 'Zerion', 'DeFi Wallet'
      ];
      
      walletModal.innerHTML = `
        <div class="wallet-selector">
          <div class="wallet-header">
            <h3>Seleziona Wallet per Mint</h3>
            <span class="wallet-close" onclick="closeWalletModal()">&times;</span>
          </div>
          <div class="mint-info">
            <p><strong>NFT:</strong> ${filename}</p>
            <p><strong>Valore:</strong> ${value} BBTM Token</p>
            <p><strong>Parola Orwell:</strong> "${quoteWord}"</p>
          </div>
          <div class="wallet-grid">
            ${wallets.map(wallet => `
              <div class="wallet-option" onclick="connectWallet('${wallet}', '${filename}', ${value}, '${quoteWord}')">
                <div class="wallet-icon">üîó</div>
                <div class="wallet-name">${wallet}</div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
      
      document.body.appendChild(walletModal);
    }
    
    function closeWalletModal() {
      const walletModal = document.getElementById('wallet-modal');
      if (walletModal) {
        walletModal.remove();
      }
    }
    
    async function connectWallet(walletName, filename, value, quoteWord) {
        try {
            console.log(`Connecting ${walletName} for minting ${filename} - ${value} BBTM - "${quoteWord}"`);
            
            if (typeof window.ethereum === 'undefined') {
                alert('MetaMask non installato! Installa MetaMask per continuare.');
                return;
            }
            
            // Richiedi connessione wallet
            await window.ethereum.request({ method: 'eth_requestAccounts' });
            
            // Configurazione provider
            const INFURA_RPC_URL = 'https://polygon-mainnet.infura.io/v3/c690c86b64b74bd5a69ad2d32cf2a0c6';
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            const signer = provider.getSigner();
            
            // Verifica network Polygon
            const network = await provider.getNetwork();
            if (network.chainId !== 137) {
                alert('Cambia network a Polygon Mainnet (Chain ID: 137)!');
                return;
            }
            
            // Ottieni indirizzo utente
            const userAddress = await signer.getAddress();
            const tokenId = Date.now() + Math.floor(Math.random() * 1000);
            
            // Carica contratto
            const contractAddress = '0xbBf8573736e6D1f20a26d2F0B8319C8021B015D1';
            const contract = new ethers.Contract(contractAddress, contractABI, signer);
            
            // Stima gas
            let gasLimit;
            try {
                const gasEstimate = await contract.estimateGas.safeMint(userAddress, tokenId);
                gasLimit = gasEstimate.mul(120).div(100); // +20% buffer
            } catch (error) {
                gasLimit = ethers.utils.parseUnits('300000', 'wei');
            }
            
            alert(`üöÄ Preparazione mint NFT con ${walletName}!
            
üìÑ Token ID: ${tokenId}
üí∞ Valore: ${value} BBTM  
üìñ Parola Orwell: "${quoteWord}"
‚õΩ Gas stimato: ${gasLimit.toString()}
üîó Network: Polygon Mainnet
            
Procedi con la transazione in MetaMask!`);
            
            closeWalletModal();
            closeModal();
            
        } catch (error) {
            console.error('Errore connessione wallet:', error);
            alert(`‚ùå Errore: ${error.message}`);
        }
    }
    document.addEventListener('keydown', function(e) {
      if (e.key === "Escape") closeModal();
    });

    // Mint NFT con Metamask
    async function mintNFT(imageName,event) {

        if (typeof window.ethereum === 'undefined') {
            alert('Per favore installa Metamask per mintare NFT.');
            return;
        }
        
        const contractAddress = '0xbBf8573736e6D1f20a26d2F0B8319C8021B015D1';

        // ‚úÖ Controllo corretto prima del log
        if (typeof contractABI === 'undefined') {
             alert('ABI non caricata! Verifica che il file abi.js sia presente.');
             return;
        }

        // ‚úÖ Ora √® sicuro loggare                 
        console.log("Ethers disponibile?", typeof ethers, ethers);
        if (typeof ethers === 'undefined') {
             alert('Ethers.js non caricato correttamente.');
             return;
        }

        const btn = event.target;
        btn.disabled = true;
        btn.textContent = "Minting...";


        try {
            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
            const account = accounts[0];
            // Configurazione Infura + MetaMask
            const INFURA_RPC_URL = 'https://polygon-mainnet.infura.io/v3/c690c86b64b74bd5a69ad2d32cf2a0c6';
            let provider;
            
            if (typeof window.ethereum !== 'undefined') {
                provider = new ethers.providers.Web3Provider(window.ethereum);
                console.log('Using MetaMask provider');
            } else {
                provider = new ethers.providers.JsonRpcProvider(INFURA_RPC_URL);
                console.log('Using Infura fallback provider');
            }
            
            const signer = provider.getSigner();
            const contract = new ethers.Contract(contractAddress, contractABI, signer);

            // Verifica network Polygon
            const network = await provider.getNetwork();
            if (network.chainId !== 137) {
                alert('Cambia network a Polygon Mainnet (Chain ID: 137)!');
                return;
            }
            
            // Genera Token ID casuale
            const tokenId = Date.now() + Math.floor(Math.random() * 1000);
            
            // Stima gas automatica
            let gasLimit;
            try {
                const gasEstimate = await contract.estimateGas.safeMint(account, tokenId);
                gasLimit = gasEstimate.mul(120).div(100); // +20% buffer
                console.log('Gas stimato:', gasLimit.toString());
            } catch (error) {
                console.log('Gas estimation fallback:', error);
                gasLimit = ethers.utils.parseUnits('300000', 'wei'); // Fallback
            }
            
            // Mint NFT con gas ottimizzato
            const tx = await contract.safeMint(account, tokenId, {
                gasLimit: gasLimit
            });
            await tx.wait();

            alert('Mint effettuato! Transazione: ' + tx.hash);
        } catch (err) {
            alert('Mint fallito: ' + (err?.reason || err?.message || err));
        } finally {
            btn.disabled = false;
            btn.textContent = "Mint NFT";        
        }
    }

    // --- Traduzioni --- (ITA/ENG demo, aggiungi o estendi le chiavi per tutte le sezioni!)
    const translations = {
        en: {
            page_title: "Big Brother The Musical - NFT Image Collection",
            main_page_title: "NFT Collection \"Big Brother The Musical\"",
            main_subtitle: "Artistic Musical Crowdfunding.<br>Press Presentation",
            toggle_button_text: "Translate and read in Italian",
            intro_para1: "Observe these images. This is not just an image gallery, but something truly innovative! It's a gallery of <b>digital values</b>, original artworks representing an ambitious creative project.",
            intro_para2: "Let me explain üëá",
            image_instruction_text: "Show image fullscreen by clicking any image",
            official_presentation_title: "Official Presentation: \"Big Brother The Musical\" ‚Äì The Ultimate Work Funded by Blockchain üéâ",
            section_intro_project: "Introduction to the Project üé≠",
            intro_project_para1: "I am here to present a project that transcends the boundaries of art and technology...",
            section_philosophy_defi: "DeFi Philosophy and the Advantage of NFTs üîó",
            philosophy_defi_para1: "Imagine decentralized finance (DeFi) as a mechanism aggregating investments directly through the global community, with maximum transparency...",
            section_smart_contract: "The Smart Contract: The Technological Heart üõ°Ô∏è",
            smart_contract_para1: "The beating heart: the Smart Contract 'Big Brother The Musical', our 'Digital Mint'...",
            smart_contract_para2: "I witnessed the genesis of this Smart Contract; it is complex, robust, and secure...",
            section_blockchain_security: "Blockchain Traceability: Transparency & Security üåç",
            blockchain_security_para1: "Every transaction is traceable and instantly recorded on a global blockchain network...",
            section_team: "Team of Excellence: Reliability Guarantee üåü",
            team_member1: "Lawyer Marcello Stanca of Florence <a href=\"https://github.com/avvstancamarcello\" target=\"_blank\">@AvvMarcelloStanca</a>, Smart Contract author.",
            team_member2: "Maestro Stefano Burbi, composer and conductor.",
            team_member3: "Fabrizio Carbon, internationally renowned executive producer.",
            section_art_collecting: "Art and Digital Collecting: Iconic NFTs üñºÔ∏è",
            art_collecting_para1: "We refined the graphic composition of the NFTs, aiming to create original and captivating NFTs...",
            call_to_action_title: "Investment Invitation & Project Quality üöÄ",
            call_to_action_para1: "Investing in 'Big Brother The Musical' means supporting art, innovating finance, and owning a piece of digital history. Join us!",
            privacy_policy_title: "Privacy Policy",
            data_collection_title: "Personal Data Collection",
            data_collection_para1: "This site does not directly collect any personally identifiable information.",
            cookies_tracking_title: "Cookies & Tracking Technologies",
            cookies_tracking_para1: "We do not use cookies or tracking technologies to monitor user behavior.",
            ipfs_content_title: "Content Hosted on IPFS",
            ipfs_content_para1: "NFT images and metadata are hosted on IPFS via public gateways. We have no control over gateway privacy practices.",
            blockchain_data_title: "Blockchain Data",
            blockchain_data_para1: "All NFT transactions occur on the Polygon blockchain. Data is public and immutable.",
            external_links_title: "External Links",
            external_links_para1: "This page may contain links to external platforms and services. We are not responsible for their privacy practices.",
            changes_policy_title: "Policy Changes",
            changes_policy_para1: "This Policy may be updated in the future.",
            last_updated_text: "Last updated: August 2, 2025",
            contact_title: "Contact",
            contact_para1: "For questions, contact us through official project channels.",
            security_recommendation_title: "Recommendations for Viewing IPFS Content",
            security_reco_para1: "Some links point to IPFS content. Security warnings may appear from browsers or antivirus. Proceed only if you trust the source.",
            footer_text: "Powered by Big Brother The Musical - Smart Contract by Avv. Marcello Stanca ¬© June 2025",
            footer_privacy_link: "Privacy Policy"
        }
    };
    let currentLang = 'it';
    function switchLanguage() {
        currentLang = currentLang === 'it' ? 'en' : 'it';
        const langData = translations[currentLang];
        document.getElementById('toggleLangButton').textContent = currentLang === 'it' ? 'Traduci e leggi in lingua inglese' : 'Translate and read in Italian';
        document.querySelectorAll('[data-key]').forEach(element => {
            const key = element.getAttribute('data-key');
            if (langData && langData[key]) {
                if (["P","LI","SPAN","A","H2","H3"].includes(element.tagName))
                    element.innerHTML = langData[key];
                else
                    element.textContent = langData[key];
            }
        });
    }
    </script>
</body>
</html>
 }
